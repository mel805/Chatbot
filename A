‚úÖ FIX APPLIQU√â - Erreur Prompt Trop Long R√©solu

## üî¥ PROBL√àME

**Erreur Discord** :
```
Error: 400 Bad Request (error code: 50035)
Invalid Form Body
In embeds.0.image.url: Must be 2048 or fewer in length
```

**Cause** : Le prompt ultra-d√©taill√© (r√©alisme 8K + qualit√© + sex-appeal + r√©p√©titions 3x + stability keywords) cr√©ait des URLs Pollinations de **3000+ caract√®res**, d√©passant la **limite Discord de 2048 caract√®res** pour les URLs d'embed.

---

## ‚úÖ SOLUTION APPLIQU√âE

### Syst√®me Dual-Prompt

**`image_generator.py`** maintenant g√©n√®re **2 versions** :

#### 1Ô∏è‚É£ **VERSION COURTE** (pour Pollinations - limite URL)
```python
realism_keywords = "photorealistic, professional photo, DSLR quality, natural lighting, detailed face"
quality_keywords = "perfect anatomy, high quality, detailed"
sexy_keywords = "attractive, sexy, seductive, beautiful"
# R√©p√©tition: 1x (pas 3x)
# Pas de stability_keywords ultra-longs
```

**Longueur** : ~400-600 caract√®res ‚Üí URL finale < 2048 caract√®res ‚úÖ

#### 2Ô∏è‚É£ **VERSION COMPL√àTE** (pour Stable Horde / Replicate)
```python
realism_keywords = "ULTRA PHOTOREALISTIC, hyperrealistic photograph, 8K resolution, DSLR camera quality, realistic human skin with pores and texture..." (12+ mots-cl√©s)
quality_keywords = "perfect anatomy, perfect hands with 5 fingers, masterpiece quality, ultra detailed..." (15+ mots-cl√©s)
sexy_keywords = "attractive, sexy, seductive look, alluring, sultry gaze, sensual pose..." (15+ mots-cl√©s)
# R√©p√©tition: 3x
# + stability_keywords complets
```

**Longueur** : ~1500-2000 caract√®res ‚Üí Qualit√© maximale ‚úÖ

---

## üîß MODIFICATIONS TECHNIQUES

### `_build_base_prompt()` :
- ‚úÖ Ajout param√®tre `short_version=False`
- ‚úÖ Logique conditionnelle pour choisir la version
- ‚úÖ Logs pour indiquer quelle version est utilis√©e

### `generate_personality_image()` :
- ‚úÖ Utilise `short_version=True` pour Pollinations
- ‚úÖ Utilise `short_version=False` (complet) pour Stable Horde/Replicate
- ‚úÖ Log de la longueur du prompt

### `generate_contextual_image()` :
- ‚úÖ **Pollinations r√©activ√© en priorit√©** (√©tait d√©sactiv√©)
- ‚úÖ **Tronque automatiquement** si prompt contextuel > 800 chars
- ‚úÖ Garde version longue pour Stable Horde/Replicate backup

---

## üìä COMPARAISON LONGUEUR PROMPTS

### Avant (causait l'erreur) :
```
Pollinations URL: ~3500 caract√®res ‚ùå > 2048 limite Discord
```

### Maintenant :
```
Pollinations URL: ~1200 caract√®res ‚úÖ < 2048 limite Discord
Stable Horde prompt: ~1800 caract√®res ‚úÖ (pas de limite)
Replicate prompt: ~1800 caract√®res ‚úÖ (pas de limite)
```

---

## üéØ R√âSULTATS ATTENDUS

‚úÖ **Pollinations fonctionne** : Plus d'erreur "Must be 2048 or fewer"
‚úÖ **Qualit√© pr√©serv√©e** : 1024x1024, enhance=true, model=flux
‚úÖ **R√©alisme maintenu** : Mots-cl√©s essentiels conserv√©s
‚úÖ **Backup optimal** : Stable Horde/Replicate gardent prompts ultra-d√©taill√©s

---

## ‚öôÔ∏è D√âPLOIEMENT

**Code pouss√©** sur `cursor/debug-image-generation-for-conversational-accuracy-30a6`

**Pour tester** :
1. ‚öôÔ∏è **Red√©marrer** sur Render
2. üß™ **Tester** `/generer_image` (devrait fonctionner sans erreur)
3. üñºÔ∏è **Tester** `/generer_contexte` (bouton sous le texte)

---

**STATUS** : ‚úÖ Commit `a9b8c7d` - Fix prompt trop long Pollinations
**PR√äT** : Red√©marrer et tester imm√©diatement !
